# 操作类医嘱数据一致性检查报告

## 一、前端硬编码数据 (frontend/src/views/OrderEntry.vue)

### operationOptions 数组（21个操作）

| OpId | 操作名称 | Category | needsResult | defaultDurationMinutes |
|------|---------|----------|-------------|----------------------|
| OP001 | 持续低流量吸氧 | Duration | false | 1440 |
| OP002 | 雾化吸入治疗 | Duration | false | 15 |
| OP003 | 经口/鼻吸痰 | Immediate | false | - |
| OP004 | 气管切开护理 | Immediate | false | - |
| OP005 | 留置胃管(鼻饲管置入) | Immediate | false | - |
| OP006 | 胃肠减压护理 | ResultPending | true | 1440 |
| OP007 | 留置导尿术 | Immediate | false | - |
| OP008 | 更换引流袋/尿袋 | Immediate | false | - |
| OP009 | 膀胱冲洗 | ResultPending | true | 60 |
| OP010 | 大量不保留灌肠 | ResultPending | true | - |
| OP011 | 快速血糖监测(末梢) | ResultPending | true | - |
| OP012 | 静脉留置针置管 | Immediate | false | - |
| OP013 | 静脉采血 | Immediate | false | - |
| OP014 | 动脉血气采集 | Immediate | false | - |
| OP015 | 静脉输血护理 | ResultPending | true | 120 |
| OP016 | 普通换药/敷料更换 | Immediate | false | - |
| OP017 | 造口护理 | Immediate | false | - |
| OP018 | 手术切口拆线 | Immediate | false | - |
| OP019 | 心电监护 | Duration | false | 1440 |
| OP020 | 微量泵/注射泵使用 | Duration | false | 60 |
| OP021 | 气压治疗(预防血栓) | Duration | false | 30 |

## 二、后端硬编码数据

### 2.1 OperationNameMap (OperationOrderService.cs)
✅ **一致** - 包含所有21个操作，名称与前端完全匹配

### 2.2 OperationNameMap (OperationOrderTaskService.cs)
✅ **一致** - 包含所有21个操作，名称与前端完全匹配

### 2.3 GetTaskCategoryFromOpId (OperationOrderTaskService.cs)

| OpId | 后端Category | 前端Category | 状态 |
|------|-------------|-------------|------|
| OP001 | Duration | Duration | ✅ |
| OP002 | Duration | Duration | ✅ |
| OP003 | Immediate | Immediate | ✅ |
| OP004 | Immediate | Immediate | ✅ |
| OP005 | Immediate | Immediate | ✅ |
| OP006 | ResultPending | ResultPending | ✅ |
| OP007 | Immediate | Immediate | ✅ |
| OP008 | Immediate | Immediate | ✅ |
| OP009 | ResultPending | ResultPending | ✅ |
| OP010 | ResultPending | ResultPending | ✅ |
| OP011 | ResultPending | ResultPending | ✅ |
| OP012 | Immediate | Immediate | ✅ |
| OP013 | Immediate | Immediate | ✅ |
| OP014 | Immediate | Immediate | ✅ |
| OP015 | ResultPending | ResultPending | ✅ |
| OP016 | Immediate | Immediate | ✅ |
| OP017 | Immediate | Immediate | ✅ |
| OP018 | Immediate | Immediate | ✅ |
| OP019 | Duration | Duration | ✅ |
| OP020 | Duration | Duration | ✅ |
| OP021 | Duration | Duration | ✅ |

✅ **完全一致** - 所有操作的类别匹配

### 2.4 GenerateResultPayloadTemplate (OperationOrderTaskService.cs)

需要结果的操作（5个）：
- ✅ OP006: 胃肠减压护理 - 有模板
- ✅ OP009: 膀胱冲洗 - 有模板
- ✅ OP010: 大量不保留灌肠 - 有模板
- ✅ OP011: 快速血糖监测(末梢) - 有模板
- ✅ OP015: 静脉输血护理 - 有模板

✅ **完全一致** - 所有需要结果的操作都有对应的模板

## 三、测试数据 (Dbinitializer.cs)

### 3.1 已存在的测试数据

| OpId | 操作名称 | Category | RequiresResult | ExpectedDurationMinutes | 状态 |
|------|---------|----------|----------------|------------------------|------|
| OP001 | 持续低流量吸氧 | Duration | false | 1440 | ✅ |
| OP002 | 雾化吸入治疗 | Duration | false | 15 | ✅ |
| OP003 | 经口/鼻吸痰 | Immediate | false | - | ✅ |
| OP004 | 气管切开护理 | Immediate | false | - | ✅ |
| OP006 | 胃肠减压护理 | ResultPending | true | 1440 | ✅ |
| OP007 | 留置导尿术 | Immediate | false | - | ✅ |
| OP008 | 更换引流袋/尿袋 | Immediate | false | - | ✅ |
| OP009 | 膀胱冲洗 | ResultPending | true | 60 | ✅ |
| OP011 | 快速血糖监测(末梢) | ResultPending | true | - | ✅ |
| OP016 | 普通换药/敷料更换 | Immediate | false | - | ✅ |
| OP017 | 造口护理 | Immediate | false | - | ✅ |
| OP018 | 手术切口拆线 | Immediate | false | - | ✅ |
| OP019 | 心电监护 | Duration | false | 1440 | ✅ |
| OP020 | 微量泵/注射泵使用 | Duration | false | 60 | ✅ |
| OP021 | 气压治疗(预防血栓) | Duration | false | 30 | ✅ |

### 3.2 缺失的测试数据

以下操作在测试数据中缺失：
- ❌ OP005: 留置胃管(鼻饲管置入)
- ❌ OP010: 大量不保留灌肠
- ❌ OP012: 静脉留置针置管
- ❌ OP013: 静脉采血
- ❌ OP014: 动脉血气采集
- ❌ OP015: 静脉输血护理

### 3.3 问题数据

1. **第1155行**：存在一个旧的测试数据
   ```csharp
   OpId = "OP003", OperationName = "血糖监测"
   ```
   - ❌ **问题**：操作名称应该是"快速血糖监测(末梢)"，OpId应该是"OP011"
   - 应该删除或修正

## 四、总结

### ✅ 一致的部分
1. 前端 operationOptions 包含所有21个操作
2. 后端 OperationNameMap（两个文件）包含所有21个操作，名称完全匹配
3. 后端 GetTaskCategoryFromOpId 与前端 category 完全一致
4. 后端 GenerateResultPayloadTemplate 覆盖所有需要结果的操作

### ❌ 需要修复的问题

1. **测试数据缺失**：缺少6个操作的测试数据
   - OP005: 留置胃管(鼻饲管置入)
   - OP010: 大量不保留灌肠
   - OP012: 静脉留置针置管
   - OP013: 静脉采血
   - OP014: 动脉血气采集
   - OP015: 静脉输血护理

2. **测试数据错误**：第1155行存在旧的测试数据
   - OpId = "OP003", OperationName = "血糖监测"
   - 应该删除或修正为 OP011

### 建议
1. 删除或修正第1155行的错误测试数据
2. 为缺失的6个操作添加测试数据（可选，因为测试数据不需要覆盖所有操作）

